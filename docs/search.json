[{"path":"https://UCSD-Salem-Lab.github.io/kdps/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 kdps authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/articles/kdps-intro.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with KDPS","text":"KDPS (Kinship Decouple Phenotype Selection) R package resolves cryptic relatedness genetic studies using phenotype-aware approach. removes related individuals based kinship IBD scores prioritizing retention subjects phenotypes interest. tool useful GWAS epidemiological studies maximizing number unrelated individuals relevant traits essential statistical power, especially rare stratified phenotypes.","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/articles/kdps-intro.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Getting Started with KDPS","text":"install latest version GitHub:","code":"if(!require(\"devtools\")){   install.packages(\"devtools\")   library(\"devtools\") }  if(!require(\"kdps\")){   devtools::install_github(\"UCSD-Salem-Lab/kdps\")   library(\"kdps\") }"},{"path":"https://UCSD-Salem-Lab.github.io/kdps/articles/kdps-intro.html","id":"example-data","dir":"Articles","previous_headings":"","what":"Example Data","title":"Getting Started with KDPS","text":"package includes two example files extdata/:","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/articles/kdps-intro.html","id":"simple_pheno-txt","dir":"Articles","previous_headings":"Example Data","what":"simple_pheno.txt","title":"Getting Started with KDPS","text":"file contains phenotypic data individuals cohort. row represents one individual. Example:","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/articles/kdps-intro.html","id":"simple_kinship-txt","dir":"Articles","previous_headings":"Example Data","what":"simple_kinship.txt","title":"Getting Started with KDPS","text":"file encodes pairwise relatedness individuals based genome-wide genotype data. Example:","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/articles/kdps-intro.html","id":"simple-example-resolving-relatedness-in-a-small-cohort","dir":"Articles","previous_headings":"","what":"Simple Example: Resolving Relatedness in a Small Cohort","title":"Getting Started with KDPS","text":"","code":"library(kdps)  phenotype_file = system.file(\"extdata\", \"simple_pheno.txt\", package = \"kdps\") kinship_file   = system.file(\"extdata\", \"simple_kinship.txt\", package = \"kdps\")  kdps_results = kdps(   phenotype_file = phenotype_file,   kinship_file = kinship_file,   fuzziness = 0,   phenotype_name = \"pheno2\",   prioritize_high = FALSE,   prioritize_low = FALSE,   phenotype_rank = c(\"DISEASED1\", \"DISEASED2\", \"HEALTHY\"),   fid_name = \"FID\",   iid_name = \"IID\",   fid1_name = \"FID1\",   iid1_name = \"IID1\",   fid2_name = \"FID2\",   iid2_name = \"IID2\",   kinship_name = \"KINSHIP\",   kinship_threshold = 0.0442,   phenotypic_naive = FALSE )  kdps_results"},{"path":"https://UCSD-Salem-Lab.github.io/kdps/articles/kdps-intro.html","id":"function-arguments","dir":"Articles","previous_headings":"","what":"Function Arguments","title":"Getting Started with KDPS","text":"Key arguments kdps() include: phenotype_file, kinship_file: File paths phenotype kinship matrices. phenotype_name: column name phenotype prioritize. phenotype_rank: Ordered levels least important. kinship_threshold: Kinship score subjects considered related. fuzziness: Controls tolerance resolving complex networks (default = 0). prioritize_high, prioritize_low: TRUE, prioritizes subjects extreme phenotype values (numeric). phenotypic_naive: TRUE, phenotype info ignored ties broken randomly.","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/articles/kdps-intro.html","id":"output","dir":"Articles","previous_headings":"","what":"Output","title":"Getting Started with KDPS","text":"output data.frame columns: FID: Family ID subject remove. IID: Individual ID subject remove. can save output text file filter individuals downstream analysis.","code":"write.table(kdps_results, file = \"subjects_to_remove.txt\", quote = FALSE, row.names = FALSE)"},{"path":"https://UCSD-Salem-Lab.github.io/kdps/articles/kdps-intro.html","id":"final-notes","dir":"Articles","previous_headings":"","what":"Final Notes","title":"Getting Started with KDPS","text":"KDPS designed large-scale studies like UK Biobank, efficient performance even complex networks. Users encouraged interpret results context potential collider bias introduced phenotype-aware filtering. large studies, consider pre-filtering unrelated individuals using tools like PLINK using KDPS final refinement. updates source code, visit: https://github.com/UCSD-Salem-Lab/kdps","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Wanjun Gu. Author, maintainer.","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gu W (2025). kdps: Kinship Decouple Phenotype Selection (KDPS). R package version 1.0.0, https://github.com/UCSD-Salem-Lab/kdps.","code":"@Manual{,   title = {kdps: Kinship Decouple and Phenotype Selection (KDPS)},   author = {Wanjun Gu},   year = {2025},   note = {R package version 1.0.0},   url = {https://github.com/UCSD-Salem-Lab/kdps}, }"},{"path":"https://UCSD-Salem-Lab.github.io/kdps/index.html","id":"kdps-","dir":"","previous_headings":"","what":"KDPS","title":"KDPS","text":"KDPS (Kinship Decouple Phenotype Selection) R package designed resolve cryptic relatedness genetic studies using phenotype-aware approach. retains subjects relevant traits pruning related individuals based kinship identity--descent (IBD) scores.","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/index.html","id":"features","dir":"","previous_headings":"","what":"Features","title":"KDPS","text":"Prioritizes individuals key phenotypes (categorical numeric) Supports phenotype ranking composite scoring Customizable pruning using fuzziness parameter Efficient biobank-scale datasets like UK Biobank Compatible kinship phenotype file formats","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"KDPS","text":"can install development version KDPS GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"UCSD-Salem-Lab/kdps\")"},{"path":"https://UCSD-Salem-Lab.github.io/kdps/index.html","id":"tutorial","dir":"","previous_headings":"","what":"Tutorial","title":"KDPS","text":"can view tutorial KDPS function :","code":"vignette(\"kdps-intro\", package = \"kdps\")"},{"path":"https://UCSD-Salem-Lab.github.io/kdps/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"KDPS","text":"","code":"library(kdps)  phenotype_file = system.file(\"extdata\", \"simple_pheno.txt\", package = \"kdps\") kinship_file   = system.file(\"extdata\", \"simple_kinship.txt\", package = \"kdps\")  kdps_results = kdps(   phenotype_file = phenotype_file,   kinship_file = kinship_file,   fuzziness = 0,   phenotype_name = \"pheno2\",   prioritize_high = FALSE,   prioritize_low = FALSE,   phenotype_rank = c(\"DISEASED1\", \"DISEASED2\", \"HEALTHY\"),   fid_name = \"FID\",   iid_name = \"IID\",   fid1_name = \"FID1\",   iid1_name = \"IID1\",   fid2_name = \"FID2\",   iid2_name = \"IID2\",   kinship_name = \"KINSHIP\",   kinship_threshold = 0.0442,   phenotypic_naive = FALSE )  head(kdps_results)"},{"path":"https://UCSD-Salem-Lab.github.io/kdps/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"KDPS","text":"KDPS Documentations Getting Started KDPS Function reference: ?kdps","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"KDPS","text":"use KDPS research, please cite: Wanjun Gu, Jiachen Xi, Steven Cao, Rany M. Salem. Kinship Decouple Phenotype Selection (KDPS). Manuscript preparation","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"KDPS","text":"package released MIT License. See LICENSE file details.","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/reference/kdps.html","id":null,"dir":"Reference","previous_headings":"","what":"Kinship Decouple and Phenotype Selection (KDPS) — kdps","title":"Kinship Decouple and Phenotype Selection (KDPS) — kdps","text":"`kdps` function identifies subjects removed study based kinship phenotype information. uses kinship matrices phenotype data evaluate prioritize subjects according phenotype scores, taking account relatedness. algorithm can prioritize subjects high low phenotype values filter subjects based kinship thresholds phenotype rankings. aims refine study population removing subjects meet specific genetic phenotypic criteria, thus enhancing robustness genetic association studies.","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/reference/kdps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Kinship Decouple and Phenotype Selection (KDPS) — kdps","text":"","code":"kdps(   phenotype_file = system.file(\"extdata\", \"simple_pheno.txt\", package = \"kdps\"),   kinship_file = system.file(\"extdata\", \"simple_kinship.txt\", package = \"kdps\"),   fuzziness = 0,   phenotype_name = \"pheno2\",   prioritize_high = FALSE,   prioritize_low = FALSE,   phenotype_rank = c(\"DISEASED1\", \"DISEASED2\", \"HEALTHY\"),   fid_name = \"FID\",   iid_name = \"IID\",   fid1_name = \"FID1\",   iid1_name = \"IID1\",   fid2_name = \"FID2\",   iid2_name = \"IID2\",   kinship_name = \"KINSHIP\",   kinship_threshold = 0.0442,   phenotypic_naive = FALSE )"},{"path":"https://UCSD-Salem-Lab.github.io/kdps/reference/kdps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Kinship Decouple and Phenotype Selection (KDPS) — kdps","text":"phenotype_file string specifying path phenotype data file. kinship_file string specifying path kinship matrix file. fuzziness integer representing level fuzziness allowed removing related subjects, default 0 (fuzziness). phenotype_name name phenotype column phenotype file. prioritize_high logical indicating whether prioritize subjects high phenotype values removal. prioritize_low logical indicating whether prioritize subjects low phenotype values removal. phenotype_rank character vector specifying ranking phenotypes highest priority (first) lowest. fid_name column name family IDs phenotype file. iid_name column name individual IDs phenotype file. fid1_name column name first individual's family ID kinship file. iid1_name column name first individual's ID kinship file. fid2_name column name second individual's family ID kinship file. iid2_name column name second individual's ID kinship file. kinship_name name kinship score column kinship file. kinship_threshold numeric threshold kinship score, individuals considered related. phenotypic_naive logical indicating whether ignore phenotype information resolving conflicts related individuals.","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/reference/kdps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Kinship Decouple and Phenotype Selection (KDPS) — kdps","text":"data frame two columns, `FID` `IID`, representing family individual IDs subjects suggested removal. output can used refine study population excluding subjects subsequent analyses.","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/reference/kdps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Kinship Decouple and Phenotype Selection (KDPS) — kdps","text":"function first processes phenotype kinship data specified files, evaluates subjects based provided parameters. calculates weights subject based phenotype uses weights along kinship information identify subjects removed minimize relatedness study population. function offers flexibility handling phenotypes ranking prioritization options can adjust stringency relatedness filtering kinship threshold fuzziness parameter.","code":""},{"path":"https://UCSD-Salem-Lab.github.io/kdps/reference/kdps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Kinship Decouple and Phenotype Selection (KDPS) — kdps","text":"","code":"kdps(   phenotype_file = system.file(\"extdata\", \"simple_pheno.txt\", package = \"kdps\"),   kinship_file = system.file(\"extdata\", \"simple_kinship.txt\", package = \"kdps\"),   fuzziness = 0,   phenotype_name = \"pheno2\",   prioritize_high = FALSE,   prioritize_low = FALSE,   phenotype_rank = c(\"DISEASED1\", \"DISEASED2\", \"HEALTHY\"),   fid_name = \"FID\",   iid_name = \"IID\",   fid1_name = \"FID1\",   iid1_name = \"IID1\",   fid2_name = \"FID2\",   iid2_name = \"IID2\",   kinship_name = \"KINSHIP\",   kinship_threshold = 0.0442,   phenotypic_naive = FALSE ) #> Error in data.table::fread(phenotype_file): Input is empty or only contains BOM or terminal control characters"}]
