<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Kinship Decouple and Phenotype Selection (KDPS) — kdps • KDPS: Kinship Decouple and Phenotype Selection</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Kinship Decouple and Phenotype Selection (KDPS) — kdps"><meta name="description" content="The `kdps` function identifies subjects to be removed from a study based on kinship and phenotype
information. It uses kinship matrices and phenotype data to evaluate and prioritize subjects
according to their phenotype scores, taking into account their relatedness. The algorithm can
prioritize subjects with high or low phenotype values and filter out subjects based on kinship
thresholds and phenotype rankings. It aims to refine the study population by removing subjects
that do not meet specific genetic and phenotypic criteria, thus enhancing the robustness of
genetic association studies."><meta property="og:description" content="The `kdps` function identifies subjects to be removed from a study based on kinship and phenotype
information. It uses kinship matrices and phenotype data to evaluate and prioritize subjects
according to their phenotype scores, taking into account their relatedness. The algorithm can
prioritize subjects with high or low phenotype values and filter out subjects based on kinship
thresholds and phenotype rankings. It aims to refine the study population by removing subjects
that do not meet specific genetic and phenotypic criteria, thus enhancing the robustness of
genetic association studies."><meta property="og:image" content="https://UCSD-Salem-Lab.github.io/kdps/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">KDPS: Kinship Decouple and Phenotype Selection</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/kdps-intro.html">Getting Started with KDPS</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/UCSD-Salem-Lab/kdps/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Kinship Decouple and Phenotype Selection (KDPS)</h1>
      <small class="dont-index">Source: <a href="https://github.com/UCSD-Salem-Lab/kdps/blob/HEAD/R/kdps.R" class="external-link"><code>R/kdps.R</code></a></small>
      <div class="d-none name"><code>kdps.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The `kdps` function identifies subjects to be removed from a study based on kinship and phenotype
information. It uses kinship matrices and phenotype data to evaluate and prioritize subjects
according to their phenotype scores, taking into account their relatedness. The algorithm can
prioritize subjects with high or low phenotype values and filter out subjects based on kinship
thresholds and phenotype rankings. It aims to refine the study population by removing subjects
that do not meet specific genetic and phenotypic criteria, thus enhancing the robustness of
genetic association studies.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">kdps</span><span class="op">(</span></span>
<span>  phenotype_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"simple_pheno.txt"</span>, package <span class="op">=</span> <span class="st">"kdps"</span><span class="op">)</span>,</span>
<span>  kinship_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"simple_kinship.txt"</span>, package <span class="op">=</span> <span class="st">"kdps"</span><span class="op">)</span>,</span>
<span>  fuzziness <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  phenotype_name <span class="op">=</span> <span class="st">"pheno2"</span>,</span>
<span>  prioritize_high <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prioritize_low <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  phenotype_rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DISEASED1"</span>, <span class="st">"DISEASED2"</span>, <span class="st">"HEALTHY"</span><span class="op">)</span>,</span>
<span>  fid_name <span class="op">=</span> <span class="st">"FID"</span>,</span>
<span>  iid_name <span class="op">=</span> <span class="st">"IID"</span>,</span>
<span>  fid1_name <span class="op">=</span> <span class="st">"FID1"</span>,</span>
<span>  iid1_name <span class="op">=</span> <span class="st">"IID1"</span>,</span>
<span>  fid2_name <span class="op">=</span> <span class="st">"FID2"</span>,</span>
<span>  iid2_name <span class="op">=</span> <span class="st">"IID2"</span>,</span>
<span>  kinship_name <span class="op">=</span> <span class="st">"KINSHIP"</span>,</span>
<span>  kinship_threshold <span class="op">=</span> <span class="fl">0.0442</span>,</span>
<span>  phenotypic_naive <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-phenotype-file">phenotype_file<a class="anchor" aria-label="anchor" href="#arg-phenotype-file"></a></dt>
<dd><p>A string specifying the path to the phenotype data file.</p></dd>


<dt id="arg-kinship-file">kinship_file<a class="anchor" aria-label="anchor" href="#arg-kinship-file"></a></dt>
<dd><p>A string specifying the path to the kinship matrix file.</p></dd>


<dt id="arg-fuzziness">fuzziness<a class="anchor" aria-label="anchor" href="#arg-fuzziness"></a></dt>
<dd><p>An integer representing the level of fuzziness allowed in removing related subjects, with a default of 0 (no fuzziness).</p></dd>


<dt id="arg-phenotype-name">phenotype_name<a class="anchor" aria-label="anchor" href="#arg-phenotype-name"></a></dt>
<dd><p>The name of the phenotype column in the phenotype file.</p></dd>


<dt id="arg-prioritize-high">prioritize_high<a class="anchor" aria-label="anchor" href="#arg-prioritize-high"></a></dt>
<dd><p>A logical indicating whether to prioritize subjects with high phenotype values for removal.</p></dd>


<dt id="arg-prioritize-low">prioritize_low<a class="anchor" aria-label="anchor" href="#arg-prioritize-low"></a></dt>
<dd><p>A logical indicating whether to prioritize subjects with low phenotype values for removal.</p></dd>


<dt id="arg-phenotype-rank">phenotype_rank<a class="anchor" aria-label="anchor" href="#arg-phenotype-rank"></a></dt>
<dd><p>A character vector specifying the ranking of phenotypes from highest priority (first) to lowest.</p></dd>


<dt id="arg-fid-name">fid_name<a class="anchor" aria-label="anchor" href="#arg-fid-name"></a></dt>
<dd><p>The column name for family IDs in the phenotype file.</p></dd>


<dt id="arg-iid-name">iid_name<a class="anchor" aria-label="anchor" href="#arg-iid-name"></a></dt>
<dd><p>The column name for individual IDs in the phenotype file.</p></dd>


<dt id="arg-fid-name">fid1_name<a class="anchor" aria-label="anchor" href="#arg-fid-name"></a></dt>
<dd><p>The column name for the first individual's family ID in the kinship file.</p></dd>


<dt id="arg-iid-name">iid1_name<a class="anchor" aria-label="anchor" href="#arg-iid-name"></a></dt>
<dd><p>The column name for the first individual's ID in the kinship file.</p></dd>


<dt id="arg-fid-name">fid2_name<a class="anchor" aria-label="anchor" href="#arg-fid-name"></a></dt>
<dd><p>The column name for the second individual's family ID in the kinship file.</p></dd>


<dt id="arg-iid-name">iid2_name<a class="anchor" aria-label="anchor" href="#arg-iid-name"></a></dt>
<dd><p>The column name for the second individual's ID in the kinship file.</p></dd>


<dt id="arg-kinship-name">kinship_name<a class="anchor" aria-label="anchor" href="#arg-kinship-name"></a></dt>
<dd><p>The name of the kinship score column in the kinship file.</p></dd>


<dt id="arg-kinship-threshold">kinship_threshold<a class="anchor" aria-label="anchor" href="#arg-kinship-threshold"></a></dt>
<dd><p>A numeric threshold for the kinship score, above which individuals are considered related.</p></dd>


<dt id="arg-phenotypic-naive">phenotypic_naive<a class="anchor" aria-label="anchor" href="#arg-phenotypic-naive"></a></dt>
<dd><p>A logical indicating whether to ignore phenotype information when resolving conflicts between related individuals.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with two columns, `FID` and `IID`, representing the family and individual IDs
of subjects suggested for removal. This output can be used to refine the study population by
excluding these subjects in subsequent analyses.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function first processes phenotype and kinship data from the specified files, then evaluates
subjects based on the provided parameters. It calculates weights for each subject based on their
phenotype and uses these weights along with the kinship information to identify subjects that
should be removed to minimize relatedness in the study population. The function offers flexibility
in handling phenotypes through ranking and prioritization options and can adjust the stringency of
relatedness filtering through the kinship threshold and fuzziness parameter.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">kdps</span><span class="op">(</span></span></span>
<span class="r-in"><span>  phenotype_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"simple_pheno.txt"</span>, package <span class="op">=</span> <span class="st">"kdps"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  kinship_file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"simple_kinship.txt"</span>, package <span class="op">=</span> <span class="st">"kdps"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  fuzziness <span class="op">=</span> <span class="fl">0</span>,</span></span>
<span class="r-in"><span>  phenotype_name <span class="op">=</span> <span class="st">"pheno2"</span>,</span></span>
<span class="r-in"><span>  prioritize_high <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  prioritize_low <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  phenotype_rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DISEASED1"</span>, <span class="st">"DISEASED2"</span>, <span class="st">"HEALTHY"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  fid_name <span class="op">=</span> <span class="st">"FID"</span>,</span></span>
<span class="r-in"><span>  iid_name <span class="op">=</span> <span class="st">"IID"</span>,</span></span>
<span class="r-in"><span>  fid1_name <span class="op">=</span> <span class="st">"FID1"</span>,</span></span>
<span class="r-in"><span>  iid1_name <span class="op">=</span> <span class="st">"IID1"</span>,</span></span>
<span class="r-in"><span>  fid2_name <span class="op">=</span> <span class="st">"FID2"</span>,</span></span>
<span class="r-in"><span>  iid2_name <span class="op">=</span> <span class="st">"IID2"</span>,</span></span>
<span class="r-in"><span>  kinship_name <span class="op">=</span> <span class="st">"KINSHIP"</span>,</span></span>
<span class="r-in"><span>  kinship_threshold <span class="op">=</span> <span class="fl">0.0442</span>,</span></span>
<span class="r-in"><span>  phenotypic_naive <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in data.table::fread(phenotype_file):</span> Input is empty or only contains BOM or terminal control characters</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Wanjun Gu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

